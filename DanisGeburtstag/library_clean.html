<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Die Verbotene Abteilung</title>
<link rel="stylesheet" href="minigames.css">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { 
    background: #000; 
    min-height: 100vh; 
    display: flex; 
    justify-content: center; 
    align-items: center;
    overflow: hidden;
}
.game-container {
    width: 100vw;
    height: 100vh;
    max-width: 1536px;
    max-height: 864px;
}
svg { width: 100%; height: 100%; display: block; }

/* Animations */
@keyframes particleDrift {
    0%, 100% { transform: translate(0, 0); opacity: 0.3; }
    25% { transform: translate(10px, -30px); opacity: 0.7; }
    50% { transform: translate(-5px, -60px); opacity: 0.4; }
    75% { transform: translate(15px, -90px); opacity: 0.6; }
}
@keyframes orbGlow {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 1; }
}
@keyframes orbFloat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.particle { animation: particleDrift 10s ease-in-out infinite; }
.particle:nth-child(2) { animation-delay: -2s; animation-duration: 12s; }
.particle:nth-child(3) { animation-delay: -4s; animation-duration: 11s; }
.particle:nth-child(4) { animation-delay: -1s; animation-duration: 13s; }
.particle:nth-child(5) { animation-delay: -3s; animation-duration: 9s; }
.particle:nth-child(6) { animation-delay: -5s; animation-duration: 14s; }

#orbProgress { animation: orbFloat 4s ease-in-out infinite; }
#orbGlow { animation: orbGlow 3s ease-in-out infinite; }

.slot {
    cursor: pointer;
    transition: all 0.3s ease;
}
.slot:hover .slot-frame {
    stroke: #ffd700;
    stroke-width: 3;
    filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.6));
}
.slot:hover .slot-bg {
    fill: rgba(255, 215, 0, 0.1);
}
</style>
</head>
<body>
<div class="game-container" id="mainLibrary">
<svg viewBox="0 0 1536 864" xmlns="http://www.w3.org/2000/svg">
<defs>
    <!-- Filters -->
    <filter id="orbGlowFilter" x="-100%" y="-100%" width="300%" height="300%">
        <feGaussianBlur stdDeviation="20" result="blur"/>
        <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <filter id="softShadow">
        <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.4"/>
    </filter>
    <filter id="innerShadow">
        <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>
        <feOffset dx="0" dy="2" result="offsetblur"/>
        <feFlood flood-color="#000" flood-opacity="0.5"/>
        <feComposite in2="offsetblur" operator="in"/>
        <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    
    <!-- Gradients -->
    <linearGradient id="bgGradient" x1="50%" y1="0%" x2="50%" y2="100%">
        <stop offset="0%" stop-color="#1a1a3e"/>
        <stop offset="50%" stop-color="#0f0f28"/>
        <stop offset="100%" stop-color="#050510"/>
    </linearGradient>
    <radialGradient id="orbCore" cx="40%" cy="40%" r="60%">
        <stop offset="0%" stop-color="#c4b5fd"/>
        <stop offset="50%" stop-color="#8b5cf6"/>
        <stop offset="100%" stop-color="#6d28d9"/>
    </radialGradient>
    <radialGradient id="orbGlowGrad" cx="50%" cy="50%" r="50%">
        <stop offset="0%" stop-color="#a78bfa" stop-opacity="0.6"/>
        <stop offset="100%" stop-color="#7c3aed" stop-opacity="0"/>
    </radialGradient>
    <linearGradient id="lightCone" x1="50%" y1="0%" x2="50%" y2="100%">
        <stop offset="0%" stop-color="#a78bfa" stop-opacity="0.25"/>
        <stop offset="100%" stop-color="#a78bfa" stop-opacity="0"/>
    </linearGradient>
    <linearGradient id="woodGrad" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stop-color="#4a3728"/>
        <stop offset="50%" stop-color="#3d2817"/>
        <stop offset="100%" stop-color="#2a1810"/>
    </linearGradient>
    <linearGradient id="shelfWood" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#5c4033"/>
        <stop offset="50%" stop-color="#3d2817"/>
        <stop offset="100%" stop-color="#2a1810"/>
    </linearGradient>
    <linearGradient id="shelfSide" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color="#2a1810"/>
        <stop offset="100%" stop-color="#1a0f08"/>
    </linearGradient>
    <linearGradient id="shelfBoard" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stop-color="#6b5344"/>
        <stop offset="50%" stop-color="#4a3728"/>
        <stop offset="100%" stop-color="#3d2817"/>
    </linearGradient>
    <linearGradient id="shelfInner" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color="#0a0810"/>
        <stop offset="50%" stop-color="#1a1410"/>
        <stop offset="100%" stop-color="#0a0810"/>
    </linearGradient>
    <linearGradient id="hudBg" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stop-color="#1a1a2e" stop-opacity="0.85"/>
        <stop offset="100%" stop-color="#0f0f1a" stop-opacity="0.9"/>
    </linearGradient>
</defs>

<!-- ========== BG LAYER ========== -->
<g id="bg">
    <rect width="1536" height="864" fill="url(#bgGradient)"/>
    <!-- Floor -->
    <rect x="0" y="720" width="1536" height="144" fill="#0a0810" opacity="0.7"/>
</g>

<!-- ========== SHELVES LAYER ========== -->
<g id="shelves">
    <!-- LEFT BOOKSHELF (3D perspective) -->
    <g id="shelfLeft" filter="url(#softShadow)">
        <!-- Left side wall (visible due to perspective) -->
        <polygon points="30,80 80,100 80,700 30,720" fill="url(#shelfSide)"/>

        <!-- Main front face -->
        <rect x="80" y="100" width="300" height="600" fill="url(#shelfWood)"/>

        <!-- Top edge highlight -->
        <rect x="80" y="100" width="300" height="3" fill="#6b5344"/>

        <!-- Shelf boards (5 levels) -->
        <rect x="85" y="180" width="290" height="14" fill="url(#shelfBoard)" rx="1"/>
        <rect x="85" y="181" width="290" height="2" fill="#7a6050"/>

        <rect x="85" y="290" width="290" height="14" fill="url(#shelfBoard)" rx="1"/>
        <rect x="85" y="291" width="290" height="2" fill="#7a6050"/>

        <rect x="85" y="400" width="290" height="14" fill="url(#shelfBoard)" rx="1"/>
        <rect x="85" y="401" width="290" height="2" fill="#7a6050"/>

        <rect x="85" y="510" width="290" height="14" fill="url(#shelfBoard)" rx="1"/>
        <rect x="85" y="511" width="290" height="2" fill="#7a6050"/>

        <rect x="85" y="620" width="290" height="14" fill="url(#shelfBoard)" rx="1"/>
        <rect x="85" y="621" width="290" height="2" fill="#7a6050"/>

        <!-- Inner shadows for depth -->
        <rect x="85" y="105" width="290" height="70" fill="url(#shelfInner)" opacity="0.6"/>
        <rect x="85" y="195" width="290" height="90" fill="url(#shelfInner)" opacity="0.6"/>
        <rect x="85" y="305" width="290" height="90" fill="url(#shelfInner)" opacity="0.6"/>
        <rect x="85" y="415" width="290" height="90" fill="url(#shelfInner)" opacity="0.6"/>
        <rect x="85" y="525" width="290" height="90" fill="url(#shelfInner)" opacity="0.6"/>

        <!-- BOOKS - Row 1 (top) -->
        <g opacity="0.9">
            <rect x="95" y="120" width="18" height="55" fill="#8b3a3a" rx="1"/>
            <line x1="95" y1="125" x2="113" y2="125" stroke="#6b2a2a" stroke-width="1"/>
            <rect x="115" y="115" width="22" height="60" fill="#2d4a6b" rx="1"/>
            <line x1="115" y1="120" x2="137" y2="120" stroke="#1d3a5b" stroke-width="1"/>
            <rect x="140" y="125" width="16" height="50" fill="#3d5a3d" rx="1"/>
            <rect x="158" y="118" width="20" height="57" fill="#5a3d5a" rx="1"/>
            <line x1="158" y1="123" x2="178" y2="123" stroke="#4a2d4a" stroke-width="1"/>
        </g>

        <!-- BOOKS - Row 2 -->
        <g opacity="0.9">
            <rect x="240" y="215" width="20" height="65" fill="#6b4423" rx="1"/>
            <line x1="240" y1="220" x2="260" y2="220" stroke="#5b3413" stroke-width="1"/>
            <rect x="262" y="210" width="24" height="70" fill="#2d3a4a" rx="1"/>
            <line x1="262" y1="215" x2="286" y2="215" stroke="#1d2a3a" stroke-width="1"/>
            <rect x="288" y="218" width="18" height="62" fill="#5a2d2d" rx="1"/>
            <rect x="308" y="212" width="22" height="68" fill="#3d4a3d" rx="1"/>
            <line x1="308" y1="217" x2="330" y2="217" stroke="#2d3a2d" stroke-width="1"/>
        </g>

        <!-- BOOKS - Row 3 -->
        <g opacity="0.9">
            <rect x="95" y="430" width="22" height="70" fill="#5a3d5a" rx="1"/>
            <line x1="95" y1="435" x2="117" y2="435" stroke="#4a2d4a" stroke-width="1"/>
            <rect x="120" y="425" width="18" height="75" fill="#8b3a3a" rx="1"/>
            <rect x="140" y="432" width="24" height="68" fill="#2d4a6b" rx="1"/>
            <line x1="140" y1="437" x2="164" y2="437" stroke="#1d3a5b" stroke-width="1"/>
            <rect x="166" y="428" width="20" height="72" fill="#3d5a3d" rx="1"/>
            <line x1="166" y1="433" x2="186" y2="433" stroke="#2d4a2d" stroke-width="1"/>
        </g>

        <!-- BOOKS - Row 4 -->
        <g opacity="0.9">
            <rect x="250" y="540" width="24" height="72" fill="#2d3a4a" rx="1"/>
            <line x1="250" y1="545" x2="274" y2="545" stroke="#1d2a3a" stroke-width="1"/>
            <rect x="276" y="535" width="20" height="77" fill="#6b4423" rx="1"/>
            <line x1="276" y1="540" x2="296" y2="540" stroke="#5b3413" stroke-width="1"/>
            <rect x="298" y="542" width="18" height="70" fill="#5a2d2d" rx="1"/>
            <rect x="318" y="538" width="22" height="74" fill="#3d4a3d" rx="1"/>
            <line x1="318" y1="543" x2="340" y2="543" stroke="#2d3a2d" stroke-width="1"/>
        </g>
    </g>

    <!-- RIGHT BOOKSHELF (3D perspective - mirrored) -->
    <g id="shelfRight" filter="url(#softShadow)">
        <!-- Right side wall (visible due to perspective) -->
        <polygon points="1506,80 1456,100 1456,700 1506,720" fill="url(#shelfSide)"/>

        <!-- Main front face -->
        <rect x="1156" y="100" width="300" height="600" fill="url(#shelfWood)"/>

        <!-- Top edge highlight -->
        <rect x="1156" y="100" width="300" height="3" fill="#6b5344"/>

        <!-- Shelf boards (5 levels) -->
        <rect x="1161" y="180" width="290" height="14" fill="url(#shelfBoard)" rx="1"/>
        <rect x="1161" y="181" width="290" height="2" fill="#7a6050"/>

        <rect x="1161" y="290" width="290" height="14" fill="url(#shelfBoard)" rx="1"/>
        <rect x="1161" y="291" width="290" height="2" fill="#7a6050"/>

        <rect x="1161" y="400" width="290" height="14" fill="url(#shelfBoard)" rx="1"/>
        <rect x="1161" y="401" width="290" height="2" fill="#7a6050"/>

        <rect x="1161" y="510" width="290" height="14" fill="url(#shelfBoard)" rx="1"/>
        <rect x="1161" y="511" width="290" height="2" fill="#7a6050"/>

        <rect x="1161" y="620" width="290" height="14" fill="url(#shelfBoard)" rx="1"/>
        <rect x="1161" y="621" width="290" height="2" fill="#7a6050"/>

        <!-- Inner shadows -->
        <rect x="1161" y="105" width="290" height="70" fill="url(#shelfInner)" opacity="0.6"/>
        <rect x="1161" y="195" width="290" height="90" fill="url(#shelfInner)" opacity="0.6"/>
        <rect x="1161" y="305" width="290" height="90" fill="url(#shelfInner)" opacity="0.6"/>
        <rect x="1161" y="415" width="290" height="90" fill="url(#shelfInner)" opacity="0.6"/>
        <rect x="1161" y="525" width="290" height="90" fill="url(#shelfInner)" opacity="0.6"/>

        <!-- BOOKS - Row 1 (more orderly) -->
        <g opacity="0.9">
            <rect x="1360" y="118" width="20" height="57" fill="#2d4a6b" rx="1"/>
            <line x1="1360" y1="123" x2="1380" y2="123" stroke="#1d3a5b" stroke-width="1"/>
            <rect x="1382" y="118" width="20" height="57" fill="#3d5a3d" rx="1"/>
            <line x1="1382" y1="123" x2="1402" y2="123" stroke="#2d4a2d" stroke-width="1"/>
            <rect x="1404" y="118" width="20" height="57" fill="#8b3a3a" rx="1"/>
            <line x1="1404" y1="123" x2="1424" y2="123" stroke="#6b2a2a" stroke-width="1"/>
            <rect x="1426" y="118" width="20" height="57" fill="#5a3d5a" rx="1"/>
        </g>

        <!-- BOOKS - Row 2 -->
        <g opacity="0.9">
            <rect x="1171" y="212" width="22" height="68" fill="#6b4423" rx="1"/>
            <line x1="1171" y1="217" x2="1193" y2="217" stroke="#5b3413" stroke-width="1"/>
            <rect x="1195" y="212" width="22" height="68" fill="#2d3a4a" rx="1"/>
            <line x1="1195" y1="217" x2="1217" y2="217" stroke="#1d2a3a" stroke-width="1"/>
            <rect x="1219" y="212" width="22" height="68" fill="#5a2d2d" rx="1"/>
            <rect x="1243" y="212" width="22" height="68" fill="#3d4a3d" rx="1"/>
            <line x1="1243" y1="217" x2="1265" y2="217" stroke="#2d3a2d" stroke-width="1"/>
        </g>

        <!-- BOOKS - Row 3 -->
        <g opacity="0.9">
            <rect x="1348" y="428" width="22" height="72" fill="#5a3d5a" rx="1"/>
            <line x1="1348" y1="433" x2="1370" y2="433" stroke="#4a2d4a" stroke-width="1"/>
            <rect x="1372" y="428" width="22" height="72" fill="#8b3a3a" rx="1"/>
            <line x1="1372" y1="433" x2="1394" y2="433" stroke="#6b2a2a" stroke-width="1"/>
            <rect x="1396" y="428" width="22" height="72" fill="#2d4a6b" rx="1"/>
            <line x1="1396" y1="433" x2="1418" y2="433" stroke="#1d3a5b" stroke-width="1"/>
            <rect x="1420" y="428" width="22" height="72" fill="#3d5a3d" rx="1"/>
        </g>

        <!-- BOOKS - Row 4 -->
        <g opacity="0.9">
            <rect x="1171" y="538" width="22" height="74" fill="#2d3a4a" rx="1"/>
            <line x1="1171" y1="543" x2="1193" y2="543" stroke="#1d2a3a" stroke-width="1"/>
            <rect x="1195" y="538" width="22" height="74" fill="#6b4423" rx="1"/>
            <line x1="1195" y1="543" x2="1217" y2="543" stroke="#5b3413" stroke-width="1"/>
            <rect x="1219" y="538" width="22" height="74" fill="#5a2d2d" rx="1"/>
        </g>

        <!-- Decorative object (small astrolabe) -->
        <g opacity="0.8">
            <circle cx="1300" cy="560" r="18" fill="#8b7355" stroke="#6b5344" stroke-width="2"/>
            <circle cx="1300" cy="560" r="12" fill="none" stroke="#4a3728" stroke-width="1"/>
            <line x1="1288" y1="560" x2="1312" y2="560" stroke="#4a3728" stroke-width="1"/>
            <line x1="1300" y1="548" x2="1300" y2="572" stroke="#4a3728" stroke-width="1"/>
        </g>
    </g>
</g>

<!-- ========== SLOTS LAYER ========== -->
<g id="slots">
    <!-- LEFT SHELF SLOTS (embedded as empty book niches) -->
    <g class="slot" id="slotL1">
        <rect class="slot-bg" x="190" y="120" width="70" height="55" rx="2" fill="#0a0810"/>
        <rect class="slot-bg" x="192" y="122" width="66" height="51" rx="2" fill="#050408"/>
        <rect class="slot-frame" x="190" y="120" width="70" height="55" rx="2" fill="none" stroke="#8b7355" stroke-width="1.5" opacity="0.5"/>
    </g>
    <g class="slot" id="slotL2">
        <rect class="slot-bg" x="95" y="215" width="70" height="65" rx="2" fill="#0a0810"/>
        <rect class="slot-bg" x="97" y="217" width="66" height="61" rx="2" fill="#050408"/>
        <rect class="slot-frame" x="95" y="215" width="70" height="65" rx="2" fill="none" stroke="#8b7355" stroke-width="1.5" opacity="0.5"/>
    </g>
    <g class="slot" id="slotL3">
        <rect class="slot-bg" x="200" y="430" width="70" height="70" rx="2" fill="#0a0810"/>
        <rect class="slot-bg" x="202" y="432" width="66" height="66" rx="2" fill="#050408"/>
        <rect class="slot-frame" x="200" y="430" width="70" height="70" rx="2" fill="none" stroke="#8b7355" stroke-width="1.5" opacity="0.5"/>
    </g>
    <g class="slot" id="slotL4">
        <rect class="slot-bg" x="95" y="540" width="70" height="72" rx="2" fill="#0a0810"/>
        <rect class="slot-bg" x="97" y="542" width="66" height="68" rx="2" fill="#050408"/>
        <rect class="slot-frame" x="95" y="540" width="70" height="72" rx="2" fill="none" stroke="#8b7355" stroke-width="1.5" opacity="0.5"/>
    </g>

    <!-- RIGHT SHELF SLOTS (embedded as empty book niches) -->
    <g class="slot" id="slotR1">
        <rect class="slot-bg" x="1276" y="118" width="70" height="57" rx="2" fill="#0a0810"/>
        <rect class="slot-bg" x="1278" y="120" width="66" height="53" rx="2" fill="#050408"/>
        <rect class="slot-frame" x="1276" y="118" width="70" height="57" rx="2" fill="none" stroke="#8b7355" stroke-width="1.5" opacity="0.5"/>
    </g>
    <g class="slot" id="slotR2">
        <rect class="slot-bg" x="1280" y="212" width="70" height="68" rx="2" fill="#0a0810"/>
        <rect class="slot-bg" x="1282" y="214" width="66" height="64" rx="2" fill="#050408"/>
        <rect class="slot-frame" x="1280" y="212" width="70" height="68" rx="2" fill="none" stroke="#8b7355" stroke-width="1.5" opacity="0.5"/>
    </g>
    <g class="slot" id="slotR3">
        <rect class="slot-bg" x="1266" y="428" width="70" height="72" rx="2" fill="#0a0810"/>
        <rect class="slot-bg" x="1268" y="430" width="66" height="68" rx="2" fill="#050408"/>
        <rect class="slot-frame" x="1266" y="428" width="70" height="72" rx="2" fill="none" stroke="#8b7355" stroke-width="1.5" opacity="0.5"/>
    </g>
    <g class="slot" id="slotR4">
        <rect class="slot-bg" x="1250" y="538" width="70" height="74" rx="2" fill="#0a0810"/>
        <rect class="slot-bg" x="1252" y="540" width="66" height="70" rx="2" fill="#050408"/>
        <rect class="slot-frame" x="1250" y="538" width="70" height="74" rx="2" fill="none" stroke="#8b7355" stroke-width="1.5" opacity="0.5"/>
    </g>
</g>

<!-- ========== DESK LAYER ========== -->
<g id="desk" filter="url(#softShadow)">
    <!-- Desk body -->
    <rect x="568" y="640" width="400" height="100" rx="6" fill="url(#woodGrad)"/>
    <!-- Desk top -->
    <ellipse cx="768" cy="640" rx="210" ry="15" fill="#5c4a3a"/>
    <rect x="558" y="625" width="420" height="15" rx="4" fill="#5c4a3a"/>

    <!-- Desk Note -->
    <g id="deskNote">
        <rect x="680" y="590" width="90" height="60" rx="2" fill="#f5e6d3" transform="rotate(-8 725 620)"/>
        <line x1="690" y1="605" x2="760" y2="600" stroke="#8b7355" stroke-width="1" opacity="0.4"/>
        <line x1="690" y1="615" x2="755" y2="610" stroke="#8b7355" stroke-width="1" opacity="0.4"/>
        <line x1="690" y1="625" x2="750" y2="620" stroke="#8b7355" stroke-width="1" opacity="0.4"/>
    </g>

    <!-- Desk Ink -->
    <g id="deskInk">
        <ellipse cx="630" cy="618" rx="14" ry="7" fill="#1a1a2e"/>
        <rect x="616" y="600" width="28" height="18" rx="4" fill="#0f0f1a"/>
        <ellipse cx="630" cy="600" rx="14" ry="6" fill="#1a1a2e"/>
        <!-- Quill -->
        <line x1="625" y1="595" x2="605" y2="555" stroke="#d4a574" stroke-width="2.5"/>
        <ellipse cx="605" cy="550" rx="8" ry="12" fill="#f5e6d3" transform="rotate(-30 605 550)"/>
    </g>

    <!-- Desk Lamp -->
    <g id="deskLamp">
        <ellipse cx="880" cy="618" rx="20" ry="8" fill="#c9a869"/>
        <rect x="875" y="565" width="10" height="53" fill="#b8941f"/>
        <path d="M860,555 Q880,545 900,555 L895,565 L865,565 Z" fill="#2a5a4a"/>
        <ellipse cx="880" cy="575" rx="18" ry="25" fill="#ffd700" opacity="0.2"/>
    </g>
</g>

<!-- ========== ORB LAYER ========== -->
<g id="orb">
    <!-- Light cone -->
    <polygon points="768,350 650,625 886,625" fill="url(#lightCone)"/>

    <!-- Orb Progress Group -->
    <g id="orbProgress">
        <!-- Outer glow -->
        <circle id="orbGlow" cx="768" cy="320" r="80" fill="url(#orbGlowGrad)" filter="url(#orbGlowFilter)"/>

        <!-- Main orb -->
        <circle cx="768" cy="320" r="50" fill="url(#orbCore)"/>

        <!-- Inner highlight -->
        <ellipse cx="755" cy="305" rx="18" ry="12" fill="#fff" opacity="0.4"/>

        <!-- Rune points (8 around circle) -->
        <circle cx="768" cy="260" r="4" fill="#c4b5fd"/>
        <circle cx="803" cy="275" r="4" fill="#c4b5fd"/>
        <circle cx="818" cy="320" r="4" fill="#c4b5fd"/>
        <circle cx="803" cy="365" r="4" fill="#c4b5fd"/>
        <circle cx="768" cy="380" r="4" fill="#c4b5fd"/>
        <circle cx="733" cy="365" r="4" fill="#c4b5fd"/>
        <circle cx="718" cy="320" r="4" fill="#c4b5fd"/>
        <circle cx="733" cy="275" r="4" fill="#c4b5fd"/>
    </g>
</g>

<!-- ========== HUD LAYER ========== -->
<g id="hud">
    <!-- HUD Panel -->
    <rect x="568" y="20" width="400" height="55" rx="8" fill="url(#hudBg)" stroke="#3d3d5c" stroke-width="2"/>

    <!-- Lock Icons -->
    <g id="hudLock1">
        <rect x="593" y="30" width="35" height="35" rx="4" fill="none" stroke="#8b7355" stroke-width="1.5"/>
        <text x="610.5" y="54" text-anchor="middle" fill="#8b7355" font-size="20">ğŸ”’</text>
    </g>
    <g id="hudLock2">
        <rect x="638" y="30" width="35" height="35" rx="4" fill="none" stroke="#8b7355" stroke-width="1.5"/>
        <text x="655.5" y="54" text-anchor="middle" fill="#8b7355" font-size="20">ğŸ”’</text>
    </g>
    <g id="hudLock3">
        <rect x="683" y="30" width="35" height="35" rx="4" fill="none" stroke="#8b7355" stroke-width="1.5"/>
        <text x="700.5" y="54" text-anchor="middle" fill="#8b7355" font-size="20">ğŸ”’</text>
    </g>
    <g id="hudLock4">
        <rect x="728" y="30" width="35" height="35" rx="4" fill="none" stroke="#8b7355" stroke-width="1.5"/>
        <text x="745.5" y="54" text-anchor="middle" fill="#8b7355" font-size="20">ğŸ”’</text>
    </g>
    <g id="hudLock5">
        <rect x="773" y="30" width="35" height="35" rx="4" fill="none" stroke="#8b7355" stroke-width="1.5"/>
        <text x="790.5" y="54" text-anchor="middle" fill="#8b7355" font-size="20">ğŸ”’</text>
    </g>
    <g id="hudLock6">
        <rect x="818" y="30" width="35" height="35" rx="4" fill="none" stroke="#8b7355" stroke-width="1.5"/>
        <text x="835.5" y="54" text-anchor="middle" fill="#8b7355" font-size="20">ğŸ”’</text>
    </g>
    <g id="hudLock7">
        <rect x="863" y="30" width="35" height="35" rx="4" fill="none" stroke="#8b7355" stroke-width="1.5"/>
        <text x="880.5" y="54" text-anchor="middle" fill="#8b7355" font-size="20">ğŸ”’</text>
    </g>
    <g id="hudLock8">
        <rect x="908" y="30" width="35" height="35" rx="4" fill="none" stroke="#8b7355" stroke-width="1.5"/>
        <text x="925.5" y="54" text-anchor="middle" fill="#8b7355" font-size="20">ğŸ”’</text>
    </g>
</g>

<!-- ========== FX LAYER ========== -->
<g id="fx">
    <circle class="particle" cx="250" cy="450" r="2.5" fill="#d4af37" opacity="0.5"/>
    <circle class="particle" cx="500" cy="350" r="2" fill="#d4af37" opacity="0.4"/>
    <circle class="particle" cx="1100" cy="400" r="2.5" fill="#d4af37" opacity="0.5"/>
    <circle class="particle" cx="1300" cy="500" r="2" fill="#d4af37" opacity="0.4"/>
    <circle class="particle" cx="400" cy="250" r="1.5" fill="#d4af37" opacity="0.6"/>
    <circle class="particle" cx="1200" cy="300" r="2" fill="#d4af37" opacity="0.5"/>
</g>

</svg>
</div>

<!-- ========================================
     MINIGAME MODALS
     ======================================== -->

<!-- Minigame 1: Polyjuice Labor -->
<div class="minigame-modal" id="minigame1">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">ğŸ§ª Das Polyjuice-Labor</h2>
            <div class="modal-controls">
                <button class="btn btn-hint" onclick="showHint(1)">ğŸ’¡ Hinweis</button>
                <button class="btn btn-reset" onclick="resetMinigame(1)">ğŸ”„ Reset</button>
                <button class="btn btn-close" onclick="closeMinigame(1)">âœ•</button>
            </div>
        </div>
        <div class="modal-body">
            <div class="hint-note">
                <p>ğŸ“œ Zerrissene Notizen:</p>
                <p>"Fluxkraut darf nicht in den Kupferkessel."</p>
                <p>"Der Kessel mit den Blutegeln steht rechts vom Eisenkessel."</p>
                <p>"Florfliegen benÃ¶tigen die hÃ¶chste Temperatur. (Stein = hÃ¶chste Temperatur)"</p>
            </div>
            <div id="polyjuiceContainer">
                <div class="cauldrons-row">
                    <div class="cauldron-slot">
                        <div class="cauldron" data-cauldron="copper" data-temp="low"></div>
                        <div class="cauldron-label">Kupfer</div>
                    </div>
                    <div class="cauldron-slot">
                        <div class="cauldron" data-cauldron="iron" data-temp="medium"></div>
                        <div class="cauldron-label">Eisen</div>
                    </div>
                    <div class="cauldron-slot">
                        <div class="cauldron" data-cauldron="tin" data-temp="medium-high"></div>
                        <div class="cauldron-label">Zinn</div>
                    </div>
                    <div class="cauldron-slot">
                        <div class="cauldron" data-cauldron="stone" data-temp="highest"></div>
                        <div class="cauldron-label">Stein</div>
                    </div>
                </div>
            </div>
            <div class="ingredients-row" id="ingredientsArea1">
                <div class="ingredient" draggable="true" data-ingredient="lacewing">
                    <div class="ingredient-icon">ğŸ¦‹</div>
                    <div class="ingredient-name">Florfliegen</div>
                </div>
                <div class="ingredient" draggable="true" data-ingredient="leech">
                    <div class="ingredient-icon">ğŸ©¸</div>
                    <div class="ingredient-name">Blutegel</div>
                </div>
                <div class="ingredient" draggable="true" data-ingredient="fluxweed">
                    <div class="ingredient-icon">ğŸŒ¿</div>
                    <div class="ingredient-name">Fluxkraut</div>
                </div>
                <div class="ingredient" draggable="true" data-ingredient="knotgrass">
                    <div class="ingredient-icon">ğŸŒ¾</div>
                    <div class="ingredient-name">KnÃ¶terich</div>
                </div>
            </div>
            <button class="btn" onclick="polyjuiceGame.check()" id="checkPolyjuiceBtn" style="margin-top: 20px; width: 100%;">âœ“ PrÃ¼fen</button>
        </div>
    </div>
</div>

<!-- Minigame 2: Die FlÃ¼sternden BuchrÃ¼cken -->
<div class="minigame-modal" id="minigame2">
    <div class="modal-content" style="max-width: 600px;">
        <div class="modal-header">
            <h2 class="modal-title">ğŸ“š Die flÃ¼sternden BuchrÃ¼cken</h2>
            <div class="modal-controls">
                <button class="btn btn-hint" onclick="showHint(2)">ğŸ’¡ Hinweis</button>
                <button class="btn btn-reset" onclick="resetMinigame(2)">ğŸ”„ Reset</button>
                <button class="btn btn-close" onclick="closeMinigame(2)">âœ•</button>
            </div>
        </div>
        <div class="modal-body">
            <div id="whisperingBooksContainer"></div>
        </div>
    </div>
</div>

<!-- Minigame 3: Bibliothekars-Chiffre -->
<div class="minigame-modal" id="minigame3">
    <div class="modal-content" style="max-width: 750px;">
        <div class="modal-header">
            <h2 class="modal-title">ğŸ“œ Die Bibliothekars-Chiffre</h2>
            <div class="modal-controls">
                <button class="btn btn-hint" onclick="showHint(3)">ğŸ’¡ Hinweis</button>
                <button class="btn btn-reset" onclick="librarianCipher.reset()">ğŸ”„ Reset</button>
                <button class="btn btn-close" onclick="closeMinigame(3)">âœ•</button>
            </div>
        </div>
        <div class="modal-body">
            <div id="cipherContainer"></div>
        </div>
    </div>
</div>

<!-- Minigame 4: Rotierende Treppen -->
<div class="minigame-modal" id="minigame4">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">ğŸªœ Die rotierenden Treppen</h2>
            <div class="modal-controls">
                <button class="btn btn-hint" onclick="showHint(4)">ğŸ’¡ Hinweis</button>
                <button class="btn btn-reset" onclick="resetMinigame(4)">ğŸ”„ Reset</button>
                <button class="btn btn-close" onclick="closeMinigame(4)">âœ•</button>
            </div>
        </div>
        <div class="modal-body">
            <div id="staircaseContainer"></div>
        </div>
    </div>
</div>

<!-- Minigame 5: Invisible Ink -->
<div class="minigame-modal" id="minigame5">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">ğŸ•¯ï¸ Invisible Ink</h2>
            <div class="modal-controls">
                <button class="btn btn-hint" onclick="showHint(5)">ğŸ’¡ Hinweis</button>
                <button class="btn btn-reset" onclick="resetMinigame(5)">ğŸ”„ Reset</button>
                <button class="btn btn-close" onclick="closeMinigame(5)">âœ•</button>
            </div>
        </div>
        <div class="modal-body">
            <p class="ink-instructions" style="text-align: center; color: #d4c4a8; font-style: italic; margin-bottom: 15px;">
                â€WÃ¤rme offenbart die Wahrheit â€“ erkenne das Symbol!"
            </p>
            <canvas id="parchmentCanvas" width="400" height="400"></canvas>
            <div class="ink-guess-container" style="margin-top: 15px; display: flex; gap: 10px; justify-content: center; align-items: center;">
                <input type="text" id="inkGuessInput" placeholder="Was siehst du?" 
                       style="padding: 10px 15px; font-size: 16px; border: 2px solid #8b7355; border-radius: 8px; 
                              background: #f5e6d3; color: #4a3520; font-family: Georgia, serif; width: 200px;"
                       onkeypress="if(event.key === 'Enter') checkInvisibleInkGuess(this.value);">
                <button onclick="checkInvisibleInkGuess(document.getElementById('inkGuessInput').value)" 
                        style="padding: 10px 20px; font-size: 16px; background: linear-gradient(135deg, #8b4513, #654321); 
                               color: #f5e6d3; border: none; border-radius: 8px; cursor: pointer; font-family: Georgia, serif;">
                    âœ¨ Raten
                </button>
            </div>
            <p class="ink-instructions" style="margin-top: 10px;">Decke das Bild mit der Kerze auf und rate, was es zeigt!</p>
        </div>
    </div>
</div>

<!-- Minigame 6: Glockenspiel -->
<div class="minigame-modal" id="minigame6">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">ğŸ”” Glockenspiel der Hauselfen</h2>
            <div class="modal-controls">
                <button class="btn btn-hint" onclick="showHint(6)">ğŸ’¡ Hinweis</button>
                <button class="btn btn-reset" onclick="resetMinigame(6)">ğŸ”„ Reset</button>
                <button class="btn btn-close" onclick="closeMinigame(6)">âœ•</button>
            </div>
        </div>
        <div class="modal-body">
            <div class="phase-indicator" id="bellPhase">Phase: VorwÃ¤rts</div>
            <div id="bellContainer"></div>
        </div>
    </div>
</div>

<!-- Minigame 7: BÃ¼cherregal -->
<div class="minigame-modal" id="minigame7">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">ğŸ“š Deep-Dive BÃ¼cherregal</h2>
            <div class="modal-controls">
                <button class="btn btn-hint" onclick="showHint(7)">ğŸ’¡ Hinweis</button>
                <button class="btn btn-reset" onclick="resetMinigame(7)">ğŸ”„ Reset</button>
                <button class="btn btn-close" onclick="closeMinigame(7)">âœ•</button>
            </div>
        </div>
        <div class="modal-body">
            <p class="sort-hint">"Vom Stein zum Tod..."</p>
            <div id="bookShelf"></div>
        </div>
    </div>
</div>

<!-- Minigame 8: Pensieve (Finale) -->
<div class="minigame-modal" id="minigame8">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">ğŸŒ€ Der Denkarium-Code</h2>
            <div class="modal-controls">
                <button class="btn btn-hint" onclick="showHint(8)">ğŸ’¡ Hinweis</button>
                <button class="btn btn-close" onclick="closeMinigame(8)">âœ•</button>
            </div>
        </div>
        <div class="modal-body">
            <div class="pensieve-basin">
                <svg width="200" height="100" viewBox="0 0 200 100">
                    <ellipse cx="100" cy="50" rx="90" ry="40" fill="rgba(139, 115, 85, 0.3)" stroke="#8b7355" stroke-width="3"/>
                    <ellipse cx="100" cy="45" rx="80" ry="35" fill="rgba(139, 115, 85, 0.1)"/>
                </svg>
            </div>
            <p style="text-align: center; margin-bottom: 20px;">Lege die Erinnerungen in der richtigen Reihenfolge ab...</p>
            <div id="penseiveSlots"></div>
            <div id="availableArtifacts"></div>
        </div>
    </div>
</div>

<!-- Minigame Scripts (modular) -->
<script src="games/minigames-core.js"></script>
<script src="games/game1-polyjuice.js"></script>
<script src="games/game2-muffliato.js"></script>
<script src="games/game3-cipher.js"></script>
<script src="games/game4-staircase.js"></script>
<script src="games/game5-invisibleink.js"></script>
<script src="games/game6-bells.js"></script>
<script src="games/game7-booksort.js"></script>
<script src="games/game8-pensieve.js"></script>
</body>
</html>
